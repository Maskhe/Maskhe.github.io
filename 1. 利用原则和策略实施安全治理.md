layout: page
title: "利用原则和策略实施安全治理"
permalink: /chapter-1

# 1. 理解和应用安全概念

安全管理理念和原则是安全策略的内在或根本指导。它还定义了安全策略设计者和系统实施者创建安全解决方案必须达到的目标。

## 1.1 CIA

CIA是最基础的安全理念，它们分别是：Confidentiality、Integrity、Availability。

- **隐私性（Confidentiality）**：在保护授权用户正常访问数据的同时，避免未授权的用户访问数据。如果隐私性被破坏，则会造成泄露（Disclosure）。

- **完整性（Integrity）**：确保数据、资源不被未授权地、错误地修改。如果真实性被破坏，就会造成Alteration。

- **可用性（Availability）**：正常用户可以实时地、不间断地访问它被授权访问的数据、资源。如果可用性被破坏，则会造成Destruction。

## 1.2 DAD

DAD分别代表 Disclosure、Alteration、Destruction，如上所述，它们是CIA被破坏后的后果。

## 1.3 过度保护（Overprotection)


有时候安全控制、策略本身就会影响系统，例如：

- 过度的隐私保护会影响可用性
- 过度的完整性保护会影响可用性
- 过度的可用性又会舍弃隐私性和完整性

所以企业需要清楚到底如果权衡取舍。

## 1.4 不可抵赖（Nonrepudiation）



有一个安全概念很重要，那就是Nonrepudiation(不可抵赖)，是指一个用户无法否认他的行为和活动。数字签名技术可以确保不可抵赖性。

## 1.5 AAA Services

还有一个安全概念很重要：AAA。

三个A分别指Authentication、Authorization、Accounting，最后一个A有时候又指Auditing，虽然这个概念里只有三个A，实际上我们在谈它时总是提到五个元素：

- Identification
- Authentication
- Authorization
- Auditing
- Accounting

这五个步骤是按顺序进行的。

Identification是表明身份，它是进行Authentication和Authorization的前提，毕竟你无法对一个没有表明身份的人进行身份验证。在一个信息系统中，Identification通常是输入用户名的那一步，而Authentication则是用户输入密码后，后端把用户提交上来的用户名和密码与数据库中的数据进行比较的一步，你会发现，Identification和Authentication总是同时发生的两步。

身份验证过后，你想要访问某个资源，还需要获得相应的授权，这就是Authorization。

为了确保用户的操作及访问是合理的，需要定期对用户的行为进行审计（Auditing），如果审计发现问题，则需要对相关用户进行问责（Accounting）。

## 1.6 保护机制（Protection Mechanisms）


- **纵深防御（Defense in Depth）**：纵深防御是一种分层防御思想，在不同层面采用多种安全控制机制，因为没有任何一种安全保护机制可以解决所有威胁，而采用多种安全保护，则可以在一种保护机制失效的情况下还能保护系统安全或威胁可控。
- **抽象（Abstraction）**：抽象是一种归类方法，有了这种思想，我们可以把拥有同样属性的资源或其他什么划分到同一个组里，并为它们施加同样的安全控制机制。
- **数据隐藏（Data Hiding）**：让未被授权的主体无法看到或访问到资源，例如虚拟机技术其实是一种数据隐藏方法，它让虚拟机无法直接访问硬件资源，data-hide是通过权限控制限制未授权的访问。**这里把Data Hide和Obscurity区分一下，Obscurity只是把敏感数据放在某个地方，但是没有安全机制阻止未授权的访问，意思就是如果恶意用户发现这个数据，仍然能够访问它。**
- **加密（Encryption）**：是数据变得不可被理解，以隐藏它的原始含义和意图。


# 2. 安全边界

安全边界介于两个区域、子网、环境的相接之处。**高安全区域和低安全区域之间存在安全边界，例如内网和互联网之间。**

当你发现安全边界之后，你就得在这个边界上实施适当的安全机制了。

在实施具体的安全控制之前，应该要评估这次安全投入是否值得，这个安全边界里面的资产价值是否值得投入那么多安全资源，当安全投入超过被保护资产的价值，这个安全投入则是不合理的。

# 3. 评估和应用安全治理原则（Security Governance）

安全治理旨在将组织内使用的安全流程和基础设施与从外部来源获得的知识和见解进行比较。

原文：Security governance seeks to compare the security processes and infra structure used within the organization with knowledge and insight obtained from external sources.

原文可能比较难理解，换句话说：安全治理是为了引入外部优秀的经验、合规要求等，以使得企业的安全水平得到提高或者符合法律、法规要求。

安全治理是紧密关联的安全解决方案和管理方法的实施，**安全治理关心各个层面的安全，而不仅仅是IT安全**。

## 3.1 第三方治理（Third Party Governance）

第三方治理可以从两个方面来看：

- 第三方机构对企业进行监管、审计
- 企业对第三方供应商提供的产品进行审查

第三方安全治理关注点在被审查对象是否满足它声明的安全目标、要求、规范以及其它合同义务。

**现场评估（On-site Assessment）** 可以提供对方采用的安全机制的第一手资料。

在第三方治理的过程中都要经过多次 **文档交换审阅(Documentation Review）** ，在这个文档交换的过程中，被审查组织需要证明它们满足审计方的要求，如果无法证明，那么则可能丢失ATO（authorization to operate），如果证明了，则可以获得ATO或TATO(temporary ATO)。

一旦被审计方丢失ATO，需要重新经过充分的审计，审计可能包含on-site review和document review，审计通过后才能重新获得ATO。

## 3.2 文档审阅（Documentation Review）

文件审查是阅读交换材料并根据标准和期望对其进行验证的过程。

文件审查通常在进行任何现场检查之前进行。

# 4. 管理安全功能（Manage Security Function）


Security Function是企业运营业务的一个方面，这个业务可以随着时间的推移评估和提升安全水平，其实可以理解为一揽子安全工作。

安全必须是可测量的，能够清晰的展示它带来了什么好处，且有一些指标供分析，例如：采取了一项安全防护措施，它降低了多少次可能发生的安全事件，检测了多少次潜在攻击等等。

## 4.1 安全机制应该和业务目标、使命、愿景对齐

实施安全机制管理时，应该采用自上而下的方式，安全机制实施团队需要说服Senior Management为安全策略背书，且由他们确定最初的安全战略。

Senior Management最终为安全策略实施不足而造成的损失负责。

如果没有高管的同意，安全计划是无用的。

**负责组织内安全的团队或部门应该是自治的，安全团队应该由直接汇报给高管（Senior Management）的CISO领导，这样可以避免一些办公室政治问题。**

原文：The team or department responsible for security within an organization should be autonomous（自治）

一个安全管理计划团队需要开发三种计划：

- **Strategic Plan（战略计划）**：应该是一个长期的（例如五年）、符合公司战略愿景的计划，b不涉及具体实施细节。
- **Tactical Plan（战术计划）**：中期计划，比战略计划更详细一点，例如，人员招聘、系统开发计划。
- **Operational Plan（可执行计划）**：短期的，具体的实施计划。

![](attachments/Pasted%20image%2020241118181856.png)

**安全是一个持续的过程**，安全管理计划也许是一个明确的起点，但是那并不意味着安全工作就做完了，安全需要不停地迭代。

## 4.2 组织流程

安全管理还需要关注组织流程上的一些事情，因为当企业采购/并购（acquisitions）、剥离（divestitures）一些东西时，都会增加企业面临的安全风险。

企业并购时需要考虑并购的那家公司之前采用的软硬件是否符合现有的安全标准，之前的工作方式、流程是否安全。

在评估第三方安全集成时，为了确保安全，可以采用以下工作流程：

- **On-Site Assessment（现场评估）**：可以到目标组织现场参观，审阅他们的人员和工作流程
- **Document Exchange and Review（文档交换和审阅）**：调查他们文档交换和审阅的机制以及评估和审阅的正式流程
- **Process/Policy Review（流程/策略评估）**：要求对方提供他们内部的安全流程/策略的副本文件审阅
- **Third-Party Audit（第三方审计）**：请独立的第三方审计机构来评估对方的资质

在采用第三方服务时，应该签订的一些协议：

- **SLA**（Service Level Agreements）：提供服务方的承诺，一般包含SLR。服务提供方会在该协议中明确它们提供怎样的服务及保障，以及未能实现承诺的赔偿。
- **SLR**（Service Level Requirements）：这个应该是由采购方发起，提出自己的要求，它是SLA的基础。

**在采用第三方服务或者和供应商合作时，应该对供应商提出最小安全要求，这些安全要求应该是和公司现有的安全策略兼容或者说一致的。**

## 4.3 组织里的角色和相应的责任

- **Senior Manager**：组织拥有者这个角色是最终为企业安全策略成败负责的角色，如果它们不在安全策略上签字同意，那么一切安全策略都是不高效的。
- **Security Professional**: The security professional, information security (InfoSec) officer, or computer incident response team (CIRT) role is assigned to a trained and experienced network, systems, and security engineer who is responsible for following the directives mandated by senior management。安全专家这个角色主要是实施者，它们负责起草安全策略和安全解决方案，但是它们并不是决定者，这些策略只有最终被Senior Manager同意后，安全专家才能去执行。
- **Asset Owner**：资产拥有者角色通常是一个高层级的管理者，他们应该最终对资产保护负责，但是他们通常会把资产托管给一个Custodian。
- **Custodian**：托管者，他们是那些按照安全策略对资产实施保护并负责的用户。他们需要执行必要的活动来保护他们负责的资产。
- **User**：用户只被授予能够支持他们完成工作或特定任务的有限的权限，他们需要遵守安全策略要求的流程和规范。
- **Auditor**：审计员负责审阅和验证安全策略以及由安全策略衍生出来的安全解决方案是合适的，并生成合规/安全报告提交给senior manager。

## 4.4 安全控制框架


### ISO

国际标准组织，ISO/IEC 27000系列是实施组织安全和相关管理的实践指导。

### NIST

National Institute of Standards and Technology。

最著名的出版物是 NIST SP 800-53，《信息系统和组织的安全和隐私控制》，这个主要是针对联邦政府及相关机构的。

### COBIT

_Control Objectives for Information and Related Technologies (COBIT)_ is a documented set of best IT security practices crafted by ISACA。

不仅针对IT安全计划，还为审计人员提供指导。

### SABSA
 
Sherwood Applied Business Security Architecture  is a framework and methodology for developing risk-driven enterprise security and information assurance architectures. It is known for its holistic and business-focused approach to security architecture.

**Risk-focused（关注风险）**：它旨在通过安全措施解决组织特定的安全风险
**Business-driven（业务驱动）**：主张安全应该集成到组织的业务流程和目标中，它帮助组织理解安全是如何支撑和帮助组织活动的。
**Layered approach（层级方法）**：通过层级结构模型来解决各层的安全问题，例如业务环境，信息域，系统，技术，物理安全等。
**Framework and methodology（框架和方法论）**：提供了一个结构化的框架来开发安全架构，以及提供了一个设计、实施、管理安全解决方案的完整方法论
**Certification（认证）**：sabsa为安全专家提供了认证程序

### PCI DSS

PCI DSS 是几个主要的信用卡公司建立的，用来保护信用卡交易的安全和持卡人的数据安全。

- 数据安全
- 网络安全
- 访问控制
- 常规监控和测试
- 信息安全策略
- 漏洞管理
- 物理安全
- 事件响应
- 合规审计
### FedRAMP

The **Federal Risk and Authorization Management Program (FedRAMP)** is a U.S. **government-wide** program designed to standardize the security assessment, authorization, and continuous monitoring processes for **cloud products and services used by federal agencies**. Its primary goal is to ensure that cloud services meet stringent security requirements and can be used by U.S. government organizations to process, store, and transmit sensitive and classified information.

- 安全标准
- 授权流程
- 持续监控
- 重用授权
- 合作
- 三个影响层级：low moderate high
- 合规框架

### ITIL

_Information Technology Infrastructure Library (ITIL)_ (`[itlibrary.org](http://itlibrary.org/)`), initially crafted by the British government, **is a set of recommended best practices for the optimization of IT services to support business growth, transformation, and change.** ITIL focuses on understanding how IT and security need to be integrated with and aligned to the objectives of an organization. ITIL and operational processes are often used as a starting point for the crafting of a customized IT security solution within an established infrastructure.

------


- COBIT：Control Objectives for Information and Related Technology，这是一个由ISACA起草的IT安全最佳实践。
	■ Provide Stakeholder Value ，提供利益相关者价值
	■ Holistic Approach ，整体性方式
	■ Dynamic Governance System ，动态治理系统
	■ Governance Distinct from Management ，治理和管理区别
	■ Tailored to Enterprise Needs ，为企业需求量身定制
	■ End-to-End Governance System，端到端的治理系统
- NIST 800-53，来自美国政府的对组织安全的通用建议
- CIS，操作系统，软件，硬件安全配置基线
- NIST Risk Management Framework（RMF）
- NIST Cybersecurity Framework (CSF)
- International Organization for Standardization (ISO)/ International Electrotechnical Commission (IEC) 27000 family group (www.itgovernanceusa.com/iso27000- family) is an international standard that can be the basis of implementing organizational security and related management practices
- Information Technology Infrastructure Library (ITIL)，由巴西政府起草，最佳安全实践。

## 4.5 尽职调查和应尽关心（Due Diligence和Due Care）

它们俩的区别，用书中的两句话来阐述一下：

Due diligence is knowing what should be done and planning for it; due care is doing the right action at the right time。

Due diligence is establishing a plan, policy, and process to protect the interests of an organization. Due care is practicing the individual activities that maintain the due diligence effort.


# 5. 安全策略、标准、流程和指导

制定和实施记录在案的安全策略、标准、程序和指导，可以构建可靠的安全基础设施。

- **Security Policies 是一个战略性的方案，它从更广的视野出发，考虑企业在各个方面可能面对的安全问题，并提供应对策略，它不涉及具体的行为，而是一个指导方针。**

而Standards、Baselines、Guidelines则是更具体的方案细节，下面是它们的一些区别。

- Security Standards：强制（compulsory）要求，必须要遵守的。
- Security Baselines：最小安全要求（minimum requirements)。
- Security Guidelines：建议，它是一个recommendations。它不是强制的
- Security Procedures：a detailed, step-by-step how-to document that describes the exact actions necessary to implement a specific security mechanism, control, or solution。最详细的操作指引。例如SOP（标准操作流程）

在答题时，只要抓住上面这些关键词就能区分出它们。
# 6. 威胁建模

## 6.1 识别威胁

威胁建模的最终目标是找出组织有价值资产面对的威胁，并对它们进行优先级排序。

识别威胁，有三种方式：

- 面向资产
- 面向攻击者
- 面向软件

### STRIDE

威胁的分类

为了能够识别出威胁，我们可以采取一些知名的威胁建模框架，例如微软开发的STRIDE模型:

- Spoofing（欺骗）
- Tampering（篡改）
- Repudiation（抵赖）
- Information Disclosure（信息泄露）
- Denial of service（拒绝服务）
- Elevation of privilege（权限提升）

### PASTA模型

威胁建模方法论

pasta是一个以**风险为中心**的威胁建模方法论

1. 定义风险分析的目标
2. 定义技术范围
3. 解构应用并分析
4. 威胁分析
5. 弱点和漏洞分析
6. 攻击建模和模拟
7. 风险分析和管理

### VAST

Visual , Agile ， Simple Threat，将威胁和风险管理集成到敏捷开发的过程中



## 6.2 确定潜在攻击并绘制图表

绘制出一个系统中涉及到的所有关键组件及安全边界，并识别它们面临的攻击，务必列出所有类型的攻击，技术的、物理的、社会工程的。

![](attachments/Pasted%20image%2020241119115541.png)

## 6.3 执行简化分析

**简化分析（reduction analysis）**也称为分解应用程序、系统或环境，通过专注单个软件或系统进行深度分析，更好地理解产品的逻辑、内部组件以及与外部元素的交互，也就能更好的识别威胁。分解过程中需要关注的五个要素：

- **信任边界**：信任和安全发生变化的任何位置。
- **数据流路径**：数据在位置之间的移动。
- **输入点**：接收外部输入的位置。
- **特权操作**：需要执行特权操作的活动。
- **安全声明和方法的细节**：安全策略、安全基础和安全假设的声明。

分解应用是为了更清楚地了解应用地各个部分，只有应用了解地越清楚，才可以更好地识别出应用面对地威胁。

在识别出威胁后，我们需要用文档记录下来威胁可能采用的方法、目标以及可能造成的后果。更进一步，我们可以列出相应的应对方法。
## 6.4 确定优先级并响应

在识别出威胁后，需要对威胁进行优先级排名。书中提到了三种方式：

- 可能性 x 潜在破坏排名：根据威胁发生的可能性和潜在破坏两个维度进行打分，高可能性高破坏的威胁需要优先处理。
	![](attachments/Pasted%20image%2020241119141754.png)
- 高/中/低打分
- DREAD系统

**DREAD的几个衡量指标**：

- Damage Potential：如果威胁得到实现，损害可能有多严重？
- Reproducibility：攻击者重现漏洞利用有多复杂？
- Exploitability：执行攻击的难度有多大？
- Affected Users：可能受攻击影响的用户数（百分比）？
- Discoverability：攻击者发现弱点的难度有多大？

当确定了威胁的优先级过后，**就需要根据投入产出比选择合适的安全应对方案了**。

这整个过程和后续将要讨论的风险评估有点类似，**但是在威胁建模过程中关注的是威胁，而风险评估过程中关注的是资产**。

# 7. 供应链风险管理（Supply Chain Risk Management）


供应链风险管理 （SCRM） 是确保供应链中的所有供应商或环节都是可靠、值得信赖、信誉良好的组织的方法，这些组织会向其业务合作伙伴（尽管不一定向公众）披露其实践和安全要求。

SCRM可能使用各种安全机制，例如silicon root of trust，physically unclonable functions(PUFs)， SBOM

silicon RoT：
PUFs：对一个物理组件生成一个唯一的指纹
SBOM



----

cissp notes: https://firmianay.gitbook.io/cissp-notes/d1_security_and_risk_management

cissp笔记： https://cissp.icsec.wiki/