# 重点

- 理解安全评估与测试程序的重要性
- 执行漏洞评估和渗透测试
- 执行软件测试以验证代码是否进入生产环境
- 理解静态、动态软件测试的差异
- 解释fuzzing的概念
- 执行安全管理任务以监督信息安全计划
- 进行或促进内部和第三方审计。
- 收集安全流程数据

# 构建一个安全评估和测试程序

## 安全测试（Security Testing）

安全测试验证安全控制是否正常运行。这些测试包括自动扫描、工具辅助渗透测试和破坏安全性的手动尝试。

安全测试应定期进行，并注意保护组织的每项关键安全控制措施

## 安全评估（Security Assessments）

安全评估是对系统、应用程序或其他测试环境的安全性的全面审查。

安全评估通常包括使用安全测试工具，但不包括自动扫描和手动渗透测试。它们还包括对威胁环境、当前和未来风险以及目标环境价值的深思熟虑的审查

**安全评估的主要工作成果通常是一份提交给管理层的评估报告，该报告以非技术语言包含评估结果，并作为提高测试环境安全性的具体建议作为结论。**

NIST发布了一项关于安全和隐私评估的最佳实践刊物：[NIST SP 800-53A]([Assessing Security and Privacy Controls in Federal Information Systems and Organizations: Building Effective Assessment Plans](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53Ar4.pdf))
## 安全审计（Security Audits）

安全审计使用许多与安全评估期间相同的技术，**但必须由独立审计员执行**。

审计员提供安全控制状态的公正、公正的观点。他们编写的报告与安全评估报告非常相似，**但这些报告适用于不同的受众**，可能包括组织的董事会、政府监管机构和其他第三方。

### 内部审计（Internal Audits）

内部审计（internal audits）由组织的内部审计人员执行，通常面向内部受众。**内部审计人员应该和他们审计的系统没有任何利益牵扯。**

首席审计执行官 （CAE）直接向CEO汇报结果， 也可能直接向组织的管理委员会报告。
### 外部审计（External Audits）

External audits are performed by an outside auditing firm

四大审计机构：

- Ernst & Young（安永会计师事务所）
- Deloitte（德勤）
- PricewaterhouseCoopers（普华永道）
- KPMG（毕马威）

### 第三方审计（Third-Party Audits）

第三方审核由其他组织或代表其他组织进行。例如，监管机构可能有权根据合同或法律对受监管公司启动审计。在第三方审计的情况下，发起审计的组织通常会选择审计者并设计审计范围

鉴证业务标准声明文档 18 （Statement on Standards for Attestation Engagements，SSAE 18） 标题为“控制报告”（Reporting on Controls），提供了一个通用标准，供审计师在对服务组织（Service Organization）进行评估时使用，目的是允许组织进行外部评估，而不是多个第三方评估，然后与客户和潜在客户共享生成的报告。

在美国境外，鉴证业务国际标准 （International Standard for Attestation Engagements，ISAE） 3402，服务组织控制措施的保证报告（Assurance Reports on Controls at a Service Organization）。

SSAE 18 和 ISAE 3402 项目通常称为服务组织控制 （service organization controls, SOC） 审计，它们有三种形式:

- **SOC1 Engagements**：评估可能影响财务报告准确性的组织控制措施。
- **SOC2 Engagements**：评估影响系统中存储信息的安全性 （机密性、完整性和可用性） 和隐私的组织控制措施。SOC 2 审计结果是保密的，通常仅根据 NDA 在组织外部共享。
- **SOC3 Engagements**：评估影响系统中存储的信息的安全性 （机密性、完整性和可用性） 和隐私的组织控制措施。但是，SOC 3 审计结果旨在公开披露。

除了三类 SOC 评估外，还有两种不同类型的 SOC 报告，他们在审计员提供的意见范围上存在不同：

- **Type 1 Reports**：这些报告提供了审计师对**管理层提供的描述和控制设计的适用性**的意见。I 类报表也仅涵盖特定时间点，而不是较长的时间段。**您可以将 I 类报告更多地视为一种文件审查，审计师在纸上检查内容，并确保管理层描述的控制措施合理且适当。**
- **Type 2 Reports**：这些报告更进一步，提供了**审计师对控制措施的运行效果**的意见。也就是说，审计员实际上确认控制措施运行正常。**II 型报告还涵盖较长的时间：至少六个月的运行。您可以将 II 类报告视为更像传统的审计。审计师不仅仅是检查文书工作;他们还进入并验证控件是否正常工作。**

II 型报告被认为比 I 型报告可靠得多，因为它们包括对控制的独立测试。
### 审计标准

执行审计时，应该有一个标准。

- ISACA 颁布的COBIT（Control Objectives For Information and Related Technologies）
- ISO 27001：描述了建立信息安全管理体系的标准方法。
- ISO 27002：ISO 27002 更详细地介绍了信息安全控制的细节。


# 执行漏洞评估

## 描述漏洞

安全社区开发了一些标准来描述和评估漏洞，NIST开发了Security Content Automation Protocol(SCAP)。

SCAP相关的内容有：

- **Common Vulnerabilities and Exposures (CVE)** provides a naming system for describing security vulnerabilities.
- **Common Vulnerability Scoring System (CVSS)** provides a standardized scoring system for describing the severity of security vulnerabilities.
- **Common Configuration Enumeration (CCE)** provides a naming system for system configuration issues.
- **Common Platform Enumeration (CPE)** provides a naming system for operating systems, applications, and devices.
- E**xtensible Configuration Checklist Description Format (XCCDF)** provides a language for specifying security checklists.
- **Open Vulnerability and Assessment Language (OVAL)** provides a language for describing security testing procedures.

![](attachments/Pasted%20image%2020241212170432.png)

## 漏洞扫描

- 网络发现扫描
- 网络漏洞扫描
- 应用漏洞扫描
- 数据库漏洞扫描

### 网络发现扫描

- **TCP Syn Scanning**：TCP SYN 扫描也称为“半开”扫描
- **TCP Connect Scanning**：在指定端口上打开与远程系统的完全连接。当运行扫描的用户没有运行半开扫描所需的权限时，将使用此扫描类型。大多数其他扫描类型都需要能够发送原始数据包，并且操作系统可能会限制用户发送手工制作的数据包
- **TCP ACK Scanning**：发送设置了 ACK 标志的数据包，指示它是打开连接的一部分。执行此类扫描时，可以尝试确定防火墙和防火墙方法强制实施的规则。
- **UDP Scannnig**：使用 UDP 协议执行远程系统扫描，检查活动的 UDP 服务。此扫描类型不使用三次握手，因为 UDP 是一种无连接协议。
- **Xmas Scanning**：发送设置了 FIN、PSH 和 URG 标志的数据包。设置了这么多标志的数据包据说“像圣诞树一样亮起”，该扫描由此得名。

使用nmap扫描端口时，端口扫描结果有以下三种：

- Open：该端口在远程系统上处于打开状态，并且有一个应用程序正在主动接受该端口上的连接。
- Closed：该端口可在远程系统上访问，这意味着防火墙允许访问，但没有应用程序接受该端口上的连接
- Filtered：Nmap 无法确定端口是打开还是关闭，因为 f irewall 正在干扰连接尝试

### 网络漏洞扫描

对某个端口上的服务进行漏洞扫描。

- False Positive：误报
- False Negative：漏报

漏扫通常是在没有认证的情况下执行扫描，这种扫描往往发现的漏洞很少，所以可以进行认证后扫描（authenticated scan），会授予扫描器只读权限。

备考时需要关注的服务端口：

- FTP 20/21
- SSH 22
- Tlenet 23
- SMTP 25
- DNS 53
- HTTP 80
- POP3 110
- NTP 123
- Windows File Sharing 135, 137-139, 445
- HTTPS 443
- LPR/LPD 515
- MSSQL 1433 1434
- Oracle 1521
- H.323 1720
- PPTP 1723
- RDP 3389
- HP JetDirect printing 9100

### Web漏洞扫描

Web漏洞扫描专门针对Web系统进行扫描，这一点和网络漏洞扫描区别一下。

### 数据库漏洞扫描

SQLMAP

### 漏洞管理工作流

采用漏洞管理系统的组织还应开发一种低工作方法来管理漏洞。此工作流程中的基本步骤应包括以下内容：

- **检测（detection）**：漏洞的初始识别通常是作为漏洞扫描的结果进行的。
- **验证（validation）**：扫描程序检测到漏洞后，管理员应确认漏洞以确定它不是误报
- **补救（remediation）**：应修正经过验证的漏洞。这可能包括应用供应商提供的安全补丁、修改设备配置、实施解决方法以避免漏洞，或者安装 Web 应用程序防火墙或其他阻止漏洞利用的控制措施

## 渗透测试

**渗透测试超越了漏洞测试技术，因为它实际上试图攻破系统。**

NIST 将渗透测试过程定义为由四个阶段组成：

**规划（Planning）**：包括就测试范围和参与规则达成一致。这是一个极其重要的阶段，因为它确保测试团队和管理层都对测试的性质达成一致，并且测试得到明确授权。

**信息收集和发现（Information gathering and discovery）**：使用手动和自动工具收集有关目标环境的信息

**攻击（Attack）**：试图使用手动和自动漏洞利用工具试图破坏系统安全。

**报告（Reporting）**：总结了渗透测试的结果，并提出了改进系统安全性的建议。

![](attachments/Pasted%20image%2020241212171604.png)


渗透测试分为三类：

- **白盒渗透测试（）**：为攻击者提供有关其目标系统的详细信息。这绕过了通常在攻击之前执行的许多侦测步骤，从而缩短了攻击时间并增加了发现安全漏洞的可能性。这些测试有时称为“**已知环境**”测试
- **灰盒渗透测试（）**：也称为部分知识测试，有时选择这些测试是为了平衡白盒和黑盒笔测试的优缺点。当需要黑盒结果但成本或时间限制意味着需要一些知识才能完成测试时，这种情况尤其常见。这些测试有时称为“**部分已知环境**”测试。
- **黑盒渗透测试（）**：在攻击之前不向攻击者提供任何信息。这模拟外部攻击者在参与攻击之前试图获取有关业务和技术环境的信息。这些测试有时称为 “**未知环境**” 测试。

**漏洞和攻击模拟 （Breach and attack simulation，BAS）** 平台旨在实现渗透测试的某些方面的自动化。这些系统旨在将威胁指标注入系统和网络，以触发其他安全控制。例如，BAS 平台可能会在服务器上放置可疑文件，通过网络发送信标数据包，或探测系统是否存在已知漏洞。

在运行良好的安全程序中，检测和预防控制会立即检测和/或阻止此流量，因为它可能是恶意的。**BAS 平台并不实际发动攻击，但它正在对这些安全控制进行自动化测试，以识别可能表明需要控制更新或增强的缺陷**。
## 合规检查（Compliance Checks）

合规性检查是受监管公司安全测试和评估计划的重要组成部分。这些检查验证合规性计划中列出的所有控制措施是否正常运行，以及是否有效地满足法规要求


进行合规检查可以定期维护组织合规性计划的运行状况并避免不可预见的监管问题。

# 软件测试

## 代码审查和测试

### 代码审查

最正式的代码审查流程，称为 **Fagan inspections**，遵循严格的审查和测试流程，包括六个步骤：

- 计划（Planning）
- 总览（Overview）
- 准备（Preparation）
- 审查（Inspection）
- 重做（Rework）
- 跟进（Follow-up）

![](attachments/Pasted%20image%2020241212173112.png)



### 静态测试

静态应用程序安全测试 （SAST） 通过分析源代码或编译的应用程序来评估软件的安全性，而无需运行软件

### 动态测试

动态应用程序安全测试 （DAST） 评估运行时环境中软件的安全性，通常是组织部署由其他人编写的应用程序的唯一选择

### 模糊测试

模糊测试的两个主要分类：

- **突变（哑）模糊测试（Mutation (Dumb) Fuzzing）**：从软件的实际操作中获取以前的输入值，并对其进行操作（或更改）以创建模糊输入。它可能会更改内容的字符行为者、将字符串附加到内容末尾或执行其他数据操作技术
- **生成式（智能）模糊测试（Generational (Intelligent) Fuzzing）**：根据对程序使用的数据类型的理解，开发数据模型并创建新的模糊输入。

## 接口测试

在软件测试过程中，应测试三种类型的接口：

- **API（Application Programming Interface）**：为代码模块提供一种标准化的交互方式，并且可以通过 Web 服务向外界公开。开发人员必须测试 API 以确保它们执行所有安全要求。
- **UI（User Interface）**：示例包括图形用户界面 （GUI） 和命令行界面。UI 为最终用户提供了与软件交互的能力。界面测试应包括对所有用户界面的审查，以验证它们是否正常运行
- **物理接口（Physical Interfaces）**：存在于一些操纵机器、逻辑控制器或物理世界中的其他对象的应用程序中。软件测试人员应特别注意物理接口，因为如果它们发生故障，可能会产生后果。

## 错误用例测试

在某些应用程序中，有软件用户可能试图滥用应用程序的方式的明显示例。**例如，银行软件的用户可能会尝试操纵输入字符串来访问其他用户的账户。他们也可能尝试从已经透支的账户中提取资金**。软件测试人员使用称为滥用案例测试或滥用案例测试的流程来评估其软件对这些已知风险的脆弱性

## 测试覆盖度分析

测试覆盖率分析公式可以适应使用许多不同的标准。以下是五个常见标准：

**分支覆盖率（Branch coverage）**：是否在所有 if 和 else 条件下执行了每个 if 语句？
**条件覆盖率（Condition coverage）**：代码中的每个逻辑测试是否在所有输入集下都执行了？
**函数覆盖率（Function coverage）**：代码中的每个函数都被调用并返回结果了吗？
**循环覆盖率（Loop coverage）**：是否所有循环都执行了？
**语句覆盖率（Statementcoverage）**：测试期间是否执行了每一行代码？


## 网站监控

安全专业人员还经常参与对网站的持续监控，以进行性能管理、故障排除和识别潜在的安全问题。这种类型的监控有两种不同的形式：

- **被动监控（Passive monitoring）**：通过在网站通过网络传输或到达服务器时捕获发送到网站的实际网络流量来分析该流量。
- RuM(Real User monitoring)：是被动监控的变种，通过监控单个用户的活动来跟踪用户与网站的交互情况。
- **监控合成或主动监控（Synthetic monitoring (or active monitoring)）**： 对网站执行人工事务以评估性能。这可能就像从网站请求一个页面来确定响应时间一样简单，或者它可以执行一个旨在识别事务结果的复杂脚本。

**被动监控只能在真实用户出现问题后检测到问题，因为它正在监控真实用户活动。** 被动监控对于排查用户发现的问题特别有用，因为它允许捕获与该问题相关的流量。如果测试脚本中未包含问题，**则综合监控可能会错过真实用户遇到的问题**，**但它能够在问题实际发生之前检测到问题。**

**被动监控和主动监控，这里可以理解为漏洞扫描中的被动扫描和主动扫描。**
# 实施安全管理程序

## 日志审查

集中收集日志，并审查。

## 账号管理

**执行账号审查**。

如果人手不够不能执行完整的账号审查，**可以通过取样的方式进行审查**

## 灾难恢复和业务连续性

一致的备份计划是这些工作中极其重要的组成部分。**管理人员应定期检查备份结果，以验证该过程是否有效运行并满足组织的数据保护需求**。

**定期测试灾难恢复和业务连续性控制为组织提供了有效保护**，确保他们免受业务运营中断的影响

## 培训和意识

略。

## 关键性能和风险指标

例如：

- 未关闭的漏洞数量
- 解决漏洞的时间
- 漏洞的复发情况
- 被盗账户数量（Number of compromised accounts）
- 预生产环境发现的软件漏洞数
- 重复出现的审计发现（findings）
- 用户尝试访问已知的恶意网站的次数




-----

a
d
c
c
a

a   c
b
b
d
c

d
c
b
c
a

b
b
b
b
d   b



