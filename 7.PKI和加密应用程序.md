# 1. 非对称加密

## 1.1 公私钥

略
## 1.2 RSA

略
## 1.3 EIGamal

- 优点：相比于RSA，它免费，RSA在2000年免费。
- 缺点：该算法会将其加密的任何消息的大小增加一倍。
## 1.4 Elliptic Curve（椭圆曲线）

同样的加密强度，RSA 3072 bit的key的加密效果等同于ECC 256 bit的key的效果。

## 1.5 Diffie-Hellman 密钥交换

它是一种密钥交换的思想，并不是一种明确的协议。

## 1.6 量子密码学（Quantum Cryptography）

量子计算仍然是一个新兴领域，目前，量子计算机仅限于理论研究。目前还没有人开发出有用的量子计算机的实际实现

# 2. 哈希函数

## SHA

- SHA-256 使用 512 位块大小生成 256 位消息摘要
- SHA-224 使用 SHA-256 哈希的截断版本，该哈希值下降 32 位，以使用 512 位块大小生成 224 位消息摘要
- SHA-512 使用 1,024 位块大小生成 512 位消息摘要
- SHA-384 使用 SHA-512 哈希的截断版本，该哈希值下降 128 位，以使用 1,024 位块大小生成 384 位摘要

## MD5

## RIPEMD

- RIPEMD 生成了一个 128 位的摘要，**并包含一些使其不安全的结构缺陷**
- RIPEMD-128 取代了 RIPEMD，后者也生成 128 位摘要，**但它也不再被认为是安全的**
- RIPEMD-160 是 RIPEMD-128 的替代品，**今天仍然安全，是最常用的 RIPEMD 变体**。它生成一个 160 位的哈希值

## HAVAL


## hash算法值长度对比

![](attachments/Pasted%20image%2020241203112123.png)

# 3. 数字签名

数字签名确保两件事：

- 消息接收者可以确认消息来自声称的消息发送者
- 消息在中途未被篡改

数字签名过程：

- Alice把要发送的消息做摘要，并用自己的私钥对摘要加密。并将加密后的内容附加在明文后发送给Bob。
- Bob接收到消息后，用Alice的公钥解密摘要，并用同样的hash算法对明文做一次摘要，和Alice发送过来的摘要进行对比，如果相同，则说明消息未被篡改，确保了完整性，且因为是通过Alice的公钥解密的，所以可以确认消息来自Alice，这确保了不可抵赖性。


**数字签名技术不确保隐私性。**

## HMAC

哈希消息身份验证代码 （HMAC） 算法实现了部分数字签名性质 — 它保证消息在传输过程中的完整性，但不提供不可否认性。

HMAC可以和任何标准的消息摘要算法结合，例如MD5,SHA-2，SHA3，但是它使用一个共享的密钥加密。

简而言之，它代表了未加密的消息摘要算法和基于公钥加密的计算成本高昂的数字签名算法之间的中间点
## 数字签名标准

美国的一些数字签名标准。

hash算法只能用SHA-3

**加密算法只能用：DSA、RSA、ECDSA**

本书编写于2021年，标准可能会变更。

# 4. 公钥基础设施（PKI）

## 证书

略

## 证书颁发机构

略
## 证书生命周期

### 注册

CA需要验证你的身份，身份验证通过后，你需要发送一个证书签名请求（certificate signing request ，CSR），CA会创建一个**X.509证书**，这个证书中包含你的身份信息和公钥，CA使用私钥对这个证书签名，然后发送给你。你再把这个证书分发给你得用户。

最简单、最常见的证书是域验证 （DV） 证书，其中 CA 仅验证证书使用者是否具有对域名的控制权。扩展验证 （EV） 证书提供更高级别的保证，CA 在颁发证书之前会采取措施验证证书所有者是否为合法企业

### 验证

### 撤销

查询已撤销证书的方式：

- **Certificate Revocation Lists**：证书吊销列表 （CRL） 由各个证书颁发机构维护，其中包含由 CA 颁发且已吊销的证书的序列号，以及修订生效的日期和时间
- **Online Certificate Status Protocol (OCSP)**：此协议通过提供实时证书验证方法，消除了使用证书吊销列表所固有的延迟
- **Certificate Stapling**：证书装订是在线证书状态协议的扩展，它减轻了原始协议给证书颁发机构带来的一些负担。当用户访问网站并启动安全连接时，网站会将其证书发送给最终用户，然后最终用户通常负责联系 OCSP 服务器以验证证书的有效性

## 证书格式

数字证书存在文件中，这些文件可能是二进制的也可能是文本的。

- DER（Distinguished Encoding Rules）格式，文件后缀通常是der，crt，cer。
- PEM（Privacy Enhanced Mail），DER的ascii文本版本，文件后缀通常是pem，crt。
- PFX（Personal Information Exchange）通常用于windows系统，通常以二进制形式存储，文件后缀为pfx，p12
- P7B，通常用于Windows，以ascii文本形式存储。


![](attachments/Pasted%20image%2020241203151404.png)


# 5. 非对称密钥管理

- 选择好的加密系统，受到业内专家一致认可的加密系统
- 您还必须以适当的方式选择您的密钥，例如，密钥长度，密钥随机性
- 当使用公钥加密的时候，确保私钥保密
- 当密钥使用完毕后将其报废
- 备份密钥
- 使用HSM（hardware security modules），这些硬件设备以安全的方式存储和管理加密密钥，防止人类需要直接使用密钥

# 6. 混合加密

TLS是混合密码学最著名的例子

# 7. 密码学的应用

## 移动设备

## 邮件

加密和签名邮件

### PGP（Pretty Good Privacy）

### S/MIME

Secure/Multipurpose Internet Mail Extensions

安全/多用途 Internet 邮件扩展 （S/MIME） 协议已成为加密电子邮件的事实标准。S/MIME 使用 RSA 加密算法，并已获得包括 RSA Security 在内的主要行业参与者的支持。下面这些商业产品都在使用该算法加密邮件：

- Outlook and Office 365
- Apple Mail
- Google G Suite Enterprise edition

![](attachments/Pasted%20image%2020250821114325.png)


注意：S/MIME是使用PKI进行密钥分发的

## Web应用

### SSL（Secure Sockets Layer）

略
### TLS（Transport Layer Security）

略

### 洋葱网络和暗网

略

## 隐写术（Steganography）和水印（Watermarking）

隐写术是使用加密技术将秘密消息嵌入到另一个信息中的艺术

## 网络

### 电路加密

- **链路加密**通过使用硬件解决方案或软件解决方案在两点之间创建安全隧道来保护整个通信电路，该解决方案对进入隧道一端的所有流量进行加密，并解密进入隧道另一端的所有流量
- **端到端加密**可保护两方（例如，客户端和服务器）之间的通信，并且独立于链路加密执行。端到端加密的一个例子是使用 TLS 来保护用户和 Web 服务器之间的通信。这可以防止入侵者监控加密链接安全端的流量或通过未加密链接发送的流量

The critical difference between link and end-to-end encryption is that in link encryption, all the data, including the header, trailer, address, and routing data, is also encrypted. Therefore, each packet has to be decrypted at each hop so that it can be properly routed to the next hop and then reencrypted before it can be sent along its way, which slows the routing. End-to-end encryption does not encrypt the header, trailer, address, and routing data, so it moves faster from point to point but is more susceptible to sniffers and eavesdroppers

### IPSec

- 身份验证标头 （AH） 提供消息完整性和不重复的保证。AH 还提供身份验证和访问控制，并防止重放攻击
- 封装安全负载 （ESP） 提供数据包内容的机密性和完整性。它提供加密和有限的身份验证，并防止重放攻击。

参考： https://blog.csdn.net/qq_43561370/article/details/111814842

![](attachments/Pasted%20image%2020250821114715.png)
## 新兴应用

### 区块链

略

### 轻量级加密

略
### 同态加密（Homomorphic Encryption）

我们有时在一些应用程序中希望保护个人隐私，但仍希望对其数据执行计算

同态加密（Homomorphic Encryption）是一种特殊的加密方法，允许对密文进行处理得到仍然是加密的结果。**即对密文直接进行处理，跟对明文进行处理后再对处理结果加密，得到的结果相同。从抽象代数的角度讲，保持了同态性。**

**同态加密可以保证实现处理者无法访问到数据自身的信息。**
# 8. 加密攻击

- **分析攻击（Analytic Attack）：** 这是一种代数操作，试图降低算法的复杂性。分析攻击侧重于算法本身的逻辑。
- **实施攻击（Implementation Attack）：** 这是一种利用加密系统实施中的弱点的攻击。它侧重于利用软件代码。
- **统计攻击（Statistical Attack）：** 统计攻击利用密码系统中的统计弱点，例如浮点错误和无法生成真正的随机数。
- **暴力攻击（Brute-Force Attack）：** 暴力攻击非常简单。此类攻击会尝试密钥或密码的所有可能的有效组合。它们涉及使用大量的处理能力来有条不紊地猜测用于保护加密通信的密钥
- **错误注入攻击（Fault Injection Attack）**：在这些攻击中，攻击者试图通过造成某种类型的外部故障来破坏加密设备的内部。例如，它们可能会使用高压电、高温或低温或其他因素来导致故障，从而破坏设备的安全性。
- **侧信道攻击（Side-Channel Attack）**：计算机系统会产生活动的特征足迹，例如处理器利用率、功耗或电磁辐射的变化。侧信道攻击试图使用此信息来监控系统活动并检索正在主动加密的信息。
- **时间攻击（Timing Attack）**：计时攻击是侧信道攻击的一个示例，攻击者精确测量完成加密操作所需的时间，从而获取有关可能用于破坏其安全性的加密过程的信息。**可以类比一下SQL注入攻击中的时间盲注**
- **频率分析和纯密文攻击（Frequency Analysis and the Ciphertext-Only Attack**）**：在许多情况下，您唯一可以使用的信息是加密的密文消息，这种情况称为仅密文攻击
- **已知明文攻击（Known Plaintext）**：在已知的纯文本攻击中，攻击者拥有加密消息的副本以及用于生成密文的纯文本消息（副本）
- **所选纯文本攻击（Chosen Plaintext）**：在这种攻击中，攻击者获得了与自己选择的一组明文相对应的密文。这允许攻击者尝试派生所使用的密钥，从而解密使用该密钥加密的其他信息
- **所选密文攻击（Chosen Ciphertext）**：在选定的密文攻击中，攻击者能够解密密文消息的选定部分，并使用消息的解密部分来发现密钥。
- **Meet in the Middle**：攻击者可能会使用中间人遇见攻击来击败使用两轮加密的加密算法。这是2DES算法被快速放弃的原因
- **中间人攻击**：略
- **生日攻击（Birthday）**：生日攻击，也称为冲突攻击或反向哈希匹配（请参阅第 14 章 “控制和监控访问”中对暴力破解和字典攻击的讨论），旨在发现哈希函数的一对一性质中的缺陷。在这种攻击中，恶意个人试图在数字计数签名通信中替换产生相同消息摘要的不同消息，从而保持原始数字签名的有效性。**这就是HASH碰撞**
- **重放攻击（Replay）**：**重放攻击用于针对不会破坏临时保护的加密算法。在这种攻击中，恶意个人拦截了双方之间的加密消息（通常是身份验证请求），然后 “重放” 捕获的消息以打开新会话。可以通过在每条消息中加入时间戳和到期时间，使用质询-响应机制，并使用临时会话密钥加密身份验证会话来击败这种攻击**

------

d
b
b c
c
b a

b
d
a
c b
b

c
b
b
c
a

a
c
b
a d 
a b


